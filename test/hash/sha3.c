/*
 * Copyright (C) 2022 by Gregor Pintar <grpintar@gmail.com>
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 */

#include <kripto/hash.h>
#include <kripto/hash/sha3.h>

#include "test.h"

int main(void)
{
	const struct vector vectors[12] =
	{
		{
			.message = "",
			.message_len = 0,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\x6B\x4E\x03\x42\x36\x67\xDB\xB7\x3B\x6E\x15\x45\x4F\x0E\xB1\xAB\xD4\x59\x7F\x9A\x1B\x07\x8E\x3F\x5B\x5A\x6B\xC7",
			.hash_len = 28
		},
		{
			.message = "\x01",
			.message_len = 1,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\x48\x82\x86\xD9\xD3\x27\x16\xE5\x88\x1E\xA1\xEE\x51\xF3\x6D\x36\x60\xD7\x0F\x0D\xB0\x3B\x3F\x61\x2C\xE9\xED\xA4",
			.hash_len = 28
		},
		{
			.message = "\x31\xC8\x2D\x71\x78\x5B\x7C\xA6\xB6\x51\xCB\x6C\x8C\x9A\xD5\xE2\xAC\xEB\x0B\x06\x33\xC0\x88\xD3\x3A\xA2\x47\xAD\xA7\xA5\x94\xFF\x49\x36\xC0\x23\x25\x13\x19\x82\x0A\x9B\x19\xFC\x6C\x48\xDE\x8A\x6F\x7A\xDA\x21\x41\x76\xCC\xDA\xAD\xAE\xEF\x51\xED\x43\x71\x4A\xC0\xC8\x26\x9B\xBD\x49\x7E\x46\xE7\x8B\xB5\xE5\x81\x96\x49\x4B\x24\x71\xB1\x68\x0E\x2D\x4C\x6D\xBD\x24\x98\x31\xBD\x83\xA4\xD3\xBE\x06\xC8\xA2\xE9\x03\x93\x39\x74\xAA\x05\xEE\x74\x8B\xFE\x6E\xF3\x59\xF7\xA1\x43\xED\xF0\xD4\x91\x8D\xA9\x16\xBD\x6F\x15\xE2\x6A\x79\x0C\xFF\x51\x4B\x40\xA5\xDA\x7F\x72\xE1\xED\x2F\xE6\x3A\x05\xB8\x14\x95\x87\xBE\xA0\x56\x53\x71\x8C\xC8\x98\x0E\xAD\xBF\xEC\xA8\x5B\x7C\x9C\x28\x6D\xD0\x40\x93\x65\x85\x93\x8B\xE7\xF9\x82\x19\x70\x0C\x83\xA9\x44\x3C\x28\x56\xA8\x0F\xF4\x68\x52\xB2\x6D\x1B\x1E\xDF\x72\xA3\x02\x03\xCF\x6C\x44\xA1\x0F\xA6\xEA\xF1\x92\x01\x73\xCE\xDF\xB5\xC4\xCF\x3A\xC6\x65\xB3\x7A\x86\xED\x02\x15\x5B\xBB\xF1\x7D\xC2\xE7\x86\xAF\x94\x78\xFE\x08\x89\xD8\x6C\x5B\xFA\x85\xA2\x42\xEB\x08\x54\xB1\x48\x2B\x7B\xD1\x6F\x67\xF8\x0B\xEF\x9C\x7A\x62\x8F\x05\xA1\x07\x93\x6A\x64\x27\x3A\x97\xB0\x08\x8B\x0E\x51\x54\x51\xF9\x16\xB5\x65\x62\x30\xA1\x2B\xA6\xDC\x78",
			.message_len = 289,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\xAA\xB2\x3C\x9E\x7F\xB9\xD7\xDA\xCE\xFD\xFD\x0B\x1A\xE8\x5A\xB1\x37\x4A\xBF\xF7\xC4\xE3\xF7\x55\x6E\xCA\xE4\x12",
			.hash_len = 28
		},
		{
			.message = "",
			.message_len = 0,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\xA7\xFF\xC6\xF8\xBF\x1E\xD7\x66\x51\xC1\x47\x56\xA0\x61\xD6\x62\xF5\x80\xFF\x4D\xE4\x3B\x49\xFA\x82\xD8\x0A\x4B\x80\xF8\x43\x4A",
			.hash_len = 32
		},
		{
			.message = "\xE9",
			.message_len = 1,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\xF0\xD0\x4D\xD1\xE6\xCF\xC2\x9A\x44\x60\xD5\x21\x79\x68\x52\xF2\x5D\x9E\xF8\xD2\x8B\x44\xEE\x91\xFF\x5B\x75\x9D\x72\xC1\xE6\xD6",
			.hash_len = 32
		},
		{
			.message = "\xB1\xCA\xA3\x96\x77\x1A\x09\xA1\xDB\x9B\xC2\x05\x43\xE9\x88\xE3\x59\xD4\x7C\x2A\x61\x64\x17\xBB\xCA\x1B\x62\xCB\x02\x79\x6A\x88\x8F\xC6\xEE\xFF\x5C\x0B\x5C\x3D\x50\x62\xFC\xB4\x25\x6F\x6A\xE1\x78\x2F\x49\x2C\x1C\xF0\x36\x10\xB4\xA1\xFB\x7B\x81\x4C\x05\x78\x78\xE1\x19\x0B\x98\x35\x42\x5C\x7A\x4A\x0E\x18\x2A\xD1\xF9\x15\x35\xED\x2A\x35\x03\x3A\x5D\x8C\x67\x0E\x21\xC5\x75\xFF\x43\xC1\x94\xA5\x8A\x82\xD4\xA1\xA4\x48\x81\xDD\x61\xF9\xF8\x16\x1F\xC6\xB9\x98\x86\x0C\xBE\x49\x75\x78\x0B\xE9\x3B\x6F\x87\x98\x0B\xAD\x0A\x99\xAA\x2C\xB7\x55\x6B\x47\x8C\xA3\x5D\x1F\x37\x46\xC3\x3E\x2B\xB7\xC4\x7A\xF4\x26\x64\x1C\xC7\xBB\xB3\x42\x5E\x21\x44\x82\x03\x45\xE1\xD0\xEA\x5B\x7D\xA2\xC3\x23\x6A\x52\x90\x6A\xCD\xC3\xB4\xD3\x4E\x47\x4D\xD7\x14\xC0\xC4\x0B\xF0\x06\xA3\xA1\xD8\x89\xA6\x32\x98\x38\x14\xBB\xC4\xA1\x4F\xE5\xF1\x59\xAA\x89\x24\x9E\x7C\x73\x8B\x3B\x73\x66\x6B\xAC\x2A\x61\x5A\x83\xFD\x21\xAE\x0A\x1C\xE7\x35\x2A\xDE\x7B\x27\x8B\x58\x71\x58\xFD\x2F\xAB\xB2\x17\xAA\x1F\xE3\x1D\x0B\xDA\x53\x27\x20\x45\x59\x80\x15\xA8\xAE\x4D\x8C\xEC\x22\x6F\xEF\xA5\x8D\xAA\x05\x50\x09\x06\xC4\xD8\x5E\x75\x67",
			.message_len = 273,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\xCB\x56\x48\xA1\xD6\x1C\x6C\x5B\xDA\xCD\x96\xF8\x1C\x95\x91\xDE\xBC\x39\x50\xDC\xF6\x58\x14\x5B\x8D\x99\x65\x70\xBA\x88\x1A\x05",
			.hash_len = 32
		},
		{
			.message = "",
			.message_len = 0,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\x0C\x63\xA7\x5B\x84\x5E\x4F\x7D\x01\x10\x7D\x85\x2E\x4C\x24\x85\xC5\x1A\x50\xAA\xAA\x94\xFC\x61\x99\x5E\x71\xBB\xEE\x98\x3A\x2A\xC3\x71\x38\x31\x26\x4A\xDB\x47\xFB\x6B\xD1\xE0\x58\xD5\xF0\x04",
			.hash_len = 48
		},
		{
			.message = "\x80",
			.message_len = 1,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\x75\x41\x38\x48\x52\xE1\x0F\xF1\x0D\x5F\xB6\xA7\x21\x3A\x4A\x6C\x15\xCC\xC8\x6D\x8B\xC1\x06\x8A\xC0\x4F\x69\x27\x71\x42\x94\x4F\x4E\xE5\x0D\x91\xFD\xC5\x65\x53\xDB\x06\xB2\xF5\x03\x9C\x8A\xB7",
			.hash_len = 48
		},
		{
			.message = "\x5F\xE3\x59\x23\xB4\xE0\xAF\x7D\xD2\x49\x71\x81\x2A\x58\x42\x55\x19\x85\x0A\x50\x6D\xFA\x9B\x0D\x25\x47\x95\xBE\x78\x57\x86\xC3\x19\xA2\x56\x7C\xBA\xA5\xE3\x5B\xCF\x8F\xE8\x3D\x94\x3E\x23\xFA\x51\x69\xB7\x3A\xDC\x1F\xCF\x8B\x60\x70\x84\xB1\x5E\x6A\x01\x3D\xF1\x47\xE4\x62\x56\xE4\xE8\x03\xAB\x75\xC1\x10\xF7\x78\x48\x13\x6B\xE7\xD8\x06\xE8\xB2\xF8\x68\xC1\x6C\x3A\x90\xC1\x44\x63\x40\x70\x38\xCB\x7D\x92\x85\x07\x9E\xF1\x62\xC6\xA4\x5C\xED\xF9\xC9\xF0\x66\x37\x5C\x96\x9B\x5F\xCB\xCD\xA3\x7F\x02\xAA\xCF\xF4\xF3\x1C\xDE\xD3\x76\x75\x70\x88\x54\x26\xBE\xBD\x9E\xCA\x87\x7E\x44\x67\x4E\x9A\xE2\xF0\xC2\x4C\xDD\x0E\x7E\x1A\xAF\x1F\xF2\xFE\x7F\x80\xA1\xC4\xF5\x07\x8E\xB3\x4C\xD4\xF0\x6F\xA9\x4A\x2D\x1E\xAB\x58\x06\xCA\x43\xFD\x0F\x06\xC6\x0B\x63\xD5\x40\x2B\x95\xC7\x0C\x21\xEA\x65\xA1\x51\xC5\xCF\xAF\x82\x62\xA4\x6B\xE3\xC7\x22\x26\x4B",
			.message_len = 209,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\x30\x54\xD2\x49\xF9\x16\xA6\x03\x9B\x2A\x9C\x3E\xBE\xC1\x41\x87\x91\xA0\x60\x8A\x17\x0E\x6D\x36\x48\x60\x35\xE5\xF9\x26\x35\xEA\xBA\x98\x07\x2A\x85\x37\x3C\xB5\x4E\x2A\xE3\xF9\x82\xCE\x13\x2B",
			.hash_len = 48
		},
		{
			.message = "",
			.message_len = 0,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\xA6\x9F\x73\xCC\xA2\x3A\x9A\xC5\xC8\xB5\x67\xDC\x18\x5A\x75\x6E\x97\xC9\x82\x16\x4F\xE2\x58\x59\xE0\xD1\xDC\xC1\x47\x5C\x80\xA6\x15\xB2\x12\x3A\xF1\xF5\xF9\x4C\x11\xE3\xE9\x40\x2C\x3A\xC5\x58\xF5\x00\x19\x9D\x95\xB6\xD3\xE3\x01\x75\x85\x86\x28\x1D\xCD\x26",
			.hash_len = 64
		},
		{
			.message = "\xE5",
			.message_len = 1,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\x15\x02\x40\xBA\xF9\x5F\xB3\x6F\x8C\xCB\x87\xA1\x9A\x41\x76\x7E\x7A\xED\x95\x12\x50\x75\xA2\xB2\xDB\xBA\x6E\x56\x5E\x1C\xE8\x57\x5F\x2B\x04\x2B\x62\xE2\x9A\x04\xE9\x44\x03\x14\xA8\x21\xC6\x22\x41\x82\x96\x4D\x8B\x55\x7B\x16\xA4\x92\xB3\x80\x6F\x4C\x39\xC1",
			.hash_len = 64
		},
		{
			.message = "\x66\x4E\xF2\xE3\xA7\x05\x9D\xAF\x1C\x58\xCA\xF5\x20\x08\xC5\x22\x7E\x85\xCD\xCB\x83\xB4\xC5\x94\x57\xF0\x2C\x50\x8D\x4F\x4F\x69\xF8\x26\xBD\x82\xC0\xCF\xFC\x5C\xB6\xA9\x7A\xF6\xE5\x61\xC6\xF9\x69\x70\x00\x52\x85\xE5\x8F\x21\xEF\x65\x11\xD2\x6E\x70\x98\x89\xA7\xE5\x13\xC4\x34\xC9\x0A\x3C\xF7\x44\x8F\x0C\xAE\xEC\x71\x14\xC7\x47\xB2\xA0\x75\x8A\x3B\x45\x03\xA7\xCF\x0C\x69\x87\x3E\xD3\x1D\x94\xDB\xEF\x2B\x7B\x2F\x16\x88\x30\xEF\x7D\xA3\x32\x2C\x3D\x3E\x10\xCA\xFB\x7C\x2C\x33\xC8\x3B\xBF\x4C\x46\xA3\x1D\xA9\x0C\xFF\x3B\xFD\x4C\xCC\x6E\xD4\xB3\x10\x75\x84\x91\xEE\xBA\x60\x3A\x76",
			.message_len = 145,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\xE5\x82\x5F\xF1\xA3\xC0\x70\xD5\xA5\x2F\xBB\xE7\x11\x85\x4A\x44\x05\x54\x29\x5F\xFB\x7A\x79\x69\xA1\x79\x08\xD1\x01\x63\xBF\xBE\x8F\x1D\x52\xA6\x76\xE8\xA0\x13\x7B\x56\xA1\x1C\xDF\x0F\xFB\xB4\x56\xBC\x89\x9F\xC7\x27\xD1\x4B\xD8\x88\x22\x32\x54\x9D\x91\x4E",
			.hash_len = 64
		}
	};

	return TEST(kripto_hash_sha3, vectors, 12);
}
