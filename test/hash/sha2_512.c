/*
 * Copyright (C) 2022 by Gregor Pintar <grpintar@gmail.com>
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 */

#include <kripto/hash.h>
#include <kripto/hash/sha2_512.h>

#include "test.h"

int main(void)
{
	const struct vector vectors[8] =
	{
		{
			.message = "",
			.message_len = 0,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\xCF\x83\xE1\x35\x7E\xEF\xB8\xBD\xF1\x54\x28\x50\xD6\x6D\x80\x07\xD6\x20\xE4\x05\x0B\x57\x15\xDC\x83\xF4\xA9\x21\xD3\x6C\xE9\xCE\x47\xD0\xD1\x3C\x5D\x85\xF2\xB0\xFF\x83\x18\xD2\x87\x7E\xEC\x2F\x63\xB9\x31\xBD\x47\x41\x7A\x81\xA5\x38\x32\x7A\xF9\x27\xDA\x3E",
			.hash_len = 64
		},
		{
			.message = "a",
			.message_len = 1,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\x1F\x40\xFC\x92\xDA\x24\x16\x94\x75\x09\x79\xEE\x6C\xF5\x82\xF2\xD5\xD7\xD2\x8E\x18\x33\x5D\xE0\x5A\xBC\x54\xD0\x56\x0E\x0F\x53\x02\x86\x0C\x65\x2B\xF0\x8D\x56\x02\x52\xAA\x5E\x74\x21\x05\x46\xF3\x69\xFB\xBB\xCE\x8C\x12\xCF\xC7\x95\x7B\x26\x52\xFE\x9A\x75",
			.hash_len = 64
		},
		{
			.message = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",
			.message_len = 62,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\x1E\x07\xBE\x23\xC2\x6A\x86\xEA\x37\xEA\x81\x0C\x8E\xC7\x80\x93\x52\x51\x5A\x97\x0E\x92\x53\xC2\x6F\x53\x6C\xFC\x7A\x99\x96\xC4\x5C\x83\x70\x58\x3E\x0A\x78\xFA\x4A\x90\x04\x1D\x71\xA4\xCE\xAB\x74\x23\xF1\x9C\x71\xB9\xD5\xA3\xE0\x12\x49\xF0\xBE\xBD\x58\x94",
			.hash_len = 64
		},
		{
			.message = "a",
			.message_len = 1,
			.message_repeat = 1000000,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\xE7\x18\x48\x3D\x0C\xE7\x69\x64\x4E\x2E\x42\xC7\xBC\x15\xB4\x63\x8E\x1F\x98\xB1\x3B\x20\x44\x28\x56\x32\xA8\x03\xAF\xA9\x73\xEB\xDE\x0F\xF2\x44\x87\x7E\xA6\x0A\x4C\xB0\x43\x2C\xE5\x77\xC3\x1B\xEB\x00\x9C\x5C\x2C\x49\xAA\x2E\x4E\xAD\xB2\x17\xAD\x8C\xC0\x9B",
			.hash_len = 64
		},
		{
			.message = "",
			.message_len = 0,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\x38\xB0\x60\xA7\x51\xAC\x96\x38\x4C\xD9\x32\x7E\xB1\xB1\xE3\x6A\x21\xFD\xB7\x11\x14\xBE\x07\x43\x4C\x0C\xC7\xBF\x63\xF6\xE1\xDA\x27\x4E\xDE\xBF\xE7\x6F\x65\xFB\xD5\x1A\xD2\xF1\x48\x98\xB9\x5B",
			.hash_len = 48
		},
		{
			.message = "a",
			.message_len = 1,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\x54\xA5\x9B\x9F\x22\xB0\xB8\x08\x80\xD8\x42\x7E\x54\x8B\x7C\x23\xAB\xD8\x73\x48\x6E\x1F\x03\x5D\xCE\x9C\xD6\x97\xE8\x51\x75\x03\x3C\xAA\x88\xE6\xD5\x7B\xC3\x5E\xFA\xE0\xB5\xAF\xD3\x14\x5F\x31",
			.hash_len = 48
		},
		{
			.message = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",
			.message_len = 62,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\x17\x61\x33\x6E\x3F\x7C\xBF\xE5\x1D\xEB\x13\x7F\x02\x6F\x89\xE0\x1A\x44\x8E\x3B\x1F\xAF\xA6\x40\x39\xC1\x46\x4E\xE8\x73\x2F\x11\xA5\x34\x1A\x6F\x41\xE0\xC2\x02\x29\x47\x36\xED\x64\xDB\x1A\x84",
			.hash_len = 48
		},
		{
			.message = "a",
			.message_len = 1,
			.message_repeat = 1000000,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\x9D\x0E\x18\x09\x71\x64\x74\xCB\x08\x6E\x83\x4E\x31\x0A\x4A\x1C\xED\x14\x9E\x9C\x00\xF2\x48\x52\x79\x72\xCE\xC5\x70\x4C\x2A\x5B\x07\xB8\xB3\xDC\x38\xEC\xC4\xEB\xAE\x97\xDD\xD8\x7F\x3D\x89\x85",
			.hash_len = 48
		}
	};

	return TEST(kripto_hash_sha2_512, vectors, 8);
}
