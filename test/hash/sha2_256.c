/*
 * Copyright (C) 2022 by Gregor Pintar <grpintar@gmail.com>
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 */

#include <kripto/hash.h>
#include <kripto/hash/sha2_256.h>

#include "test.h"

int main(void)
{
	const struct vector vectors[6] =
	{
		{
			.message = "",
			.message_len = 0,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\xD1\x4A\x02\x8C\x2A\x3A\x2B\xC9\x47\x61\x02\xBB\x28\x82\x34\xC4\x15\xA2\xB0\x1F\x82\x8E\xA6\x2A\xC5\xB3\xE4\x2F",
			.hash_len = 28
		},
		{
			.message = "\xF1\x49\xE4\x1D\x84\x8F\x59\x27\x6C\xFD\xDD\x74\x3B\xAF\xA9\xA9\x0E\x1E\xE4\xA2\x63\xA1\x18\x14\x2B\x33\xE3\x70\x21\x76\xEF\x0A\x59\xF8\x23\x7A\x1C\xB5\x1B\x42\xF3\xDE\xD6\xB2\x02\xD9\xAF\x09\x97\x89\x8F\xDD\x03\xCF\x60\xBD\xA9\x51\xC5\x14\x54\x7A\x08\x50\xCE\xC2\x54\x44\xAE\x2F\x24\xCB\x71\x1B\xFB\xAF\xCC\x39\x56\xC9\x41\xD3\xDE\x69\xF1\x55\xE3\xF8\xB1\x0F\x06\xDB\x5F\x37\x35\x9B\x77\x2D\xDD\x43\xE1\x03\x5A\x0A\x0D\x3D\xB3\x32\x42\xD5\x84\x30\x33\x83\x3B\x0D\xD4\x3B\x87\x0C\x6B\xF6\x0E\x8D\xEA\xB5\x5F\x31\x7C\xC3\x27\x3F\x5E\x3B\xA7\x47\xF0\xCB\x65\x05\x0C\xB7\x22\x87\x96\x21\x0D\x92\x54\x87\x36\x43\x00\x8D\x45\xF2\x9C\xFD\x6C\x5B\x06\x0C\x9A",
			.message_len = 163,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\x9D\xB6\xDC\x3A\x23\xAB\xD7\xB6\xC3\xD7\x2C\x38\xF4\x84\x3C\x7D\xE4\x8A\x71\xD0\xBA\x91\xA8\x6B\x18\x39\x3E\x5F",
			.hash_len = 28
		},
		{
			.message = "",
			.message_len = 0,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\xE3\xB0\xC4\x42\x98\xFC\x1C\x14\x9A\xFB\xF4\xC8\x99\x6F\xB9\x24\x27\xAE\x41\xE4\x64\x9B\x93\x4C\xA4\x95\x99\x1B\x78\x52\xB8\x55",
			.hash_len = 32
		},
		{
			.message = "a",
			.message_len = 1,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\xCA\x97\x81\x12\xCA\x1B\xBD\xCA\xFA\xC2\x31\xB3\x9A\x23\xDC\x4D\xA7\x86\xEF\xF8\x14\x7C\x4E\x72\xB9\x80\x77\x85\xAF\xEE\x48\xBB",
			.hash_len = 32
		},
		{
			.message = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",
			.message_len = 62,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\xDB\x4B\xFC\xBD\x4D\xA0\xCD\x85\xA6\x0C\x3C\x37\xD3\xFB\xD8\x80\x5C\x77\xF1\x5F\xC6\xB1\xFD\xFE\x61\x4E\xE0\xA7\xC8\xFD\xB4\xC0",
			.hash_len = 32
		},
		{
			.message = "a",
			.message_len = 1,
			.message_repeat = 1000000,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\xCD\xC7\x6E\x5C\x99\x14\xFB\x92\x81\xA1\xC7\xE2\x84\xD7\x3E\x67\xF1\x80\x9A\x48\xA4\x97\x20\x0E\x04\x6D\x39\xCC\xC7\x11\x2C\xD0",
			.hash_len = 32
		}
	};

	return TEST(kripto_hash_sha2_256, vectors, 6);
}
