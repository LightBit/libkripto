/*
 * Copyright (C) 2022 by Gregor Pintar <grpintar@gmail.com>
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 */

#include <kripto/hash.h>
#include <kripto/hash/keccak1600.h>

#include "test.h"

int main(void)
{
	const struct vector vectors[13] =
	{
		{
			.message = "",
			.message_len = 0,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\xF7\x18\x37\x50\x2B\xA8\xE1\x08\x37\xBD\xD8\xD3\x65\xAD\xB8\x55\x91\x89\x56\x02\xFC\x55\x2B\x48\xB7\x39\x0A\xBD",
			.hash_len = 28
		},
		{
			.message = "The quick brown fox jumps over the lazy dog",
			.message_len = 43,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\x31\x0A\xEE\x6B\x30\xC4\x73\x50\x57\x6A\xC2\x87\x3F\xA8\x9F\xD1\x90\xCD\xC4\x88\x44\x2F\x3E\xF6\x54\xCF\x23\xFE",
			.hash_len = 28
		},
		{
			.message = "a",
			.message_len = 1,
			.message_repeat = 1000000,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\x19\xF9\x16\x7B\xE2\xA0\x4C\x43\xAB\xD0\xED\x55\x47\x88\x10\x1B\x9C\x33\x90\x31\xAC\xC8\xE1\x46\x85\x31\x30\x3F",
			.hash_len = 28
		},
		{
			.message = "",
			.message_len = 0,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\xC5\xD2\x46\x01\x86\xF7\x23\x3C\x92\x7E\x7D\xB2\xDC\xC7\x03\xC0\xE5\x00\xB6\x53\xCA\x82\x27\x3B\x7B\xFA\xD8\x04\x5D\x85\xA4\x70",
			.hash_len = 32
		},
		{
			.message = "The quick brown fox jumps over the lazy dog",
			.message_len = 43,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\x4D\x74\x1B\x6F\x1E\xB2\x9C\xB2\xA9\xB9\x91\x1C\x82\xF5\x6F\xA8\xD7\x3B\x04\x95\x9D\x3D\x9D\x22\x28\x95\xDF\x6C\x0B\x28\xAA\x15",
			.hash_len = 32
		},
		{
			.message = "a",
			.message_len = 1,
			.message_repeat = 1000000,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\xFA\xDA\xE6\xB4\x9F\x12\x9B\xBB\x81\x2B\xE8\x40\x7B\x7B\x28\x94\xF3\x4A\xEC\xF6\xDB\xD1\xF9\xB0\xF0\xC7\xE9\x85\x30\x98\xFC\x96",
			.hash_len = 32
		},
		{
			.message = "",
			.message_len = 0,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\x2C\x23\x14\x6A\x63\xA2\x9A\xCF\x99\xE7\x3B\x88\xF8\xC2\x4E\xAA\x7D\xC6\x0A\xA7\x71\x78\x0C\xCC\x00\x6A\xFB\xFA\x8F\xE2\x47\x9B\x2D\xD2\xB2\x13\x62\x33\x74\x41\xAC\x12\xB5\x15\x91\x19\x57\xFF",
			.hash_len = 48
		},
		{
			.message = "The quick brown fox jumps over the lazy dog",
			.message_len = 43,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\x28\x39\x90\xFA\x9D\x5F\xB7\x31\xD7\x86\xC5\xBB\xEE\x94\xEA\x4D\xB4\x91\x0F\x18\xC6\x2C\x03\xD1\x73\xFC\x0A\x5E\x49\x44\x22\xE8\xA0\xB3\xDA\x75\x74\xDA\xE7\xFA\x0B\xAF\x00\x5E\x50\x40\x63\xB3",
			.hash_len = 48
		},
		{
			.message = "a",
			.message_len = 1,
			.message_repeat = 1000000,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\x0C\x83\x24\xE1\xEB\xC1\x82\x82\x2C\x5E\x2A\x08\x6C\xAC\x07\xC2\xFE\x00\xE3\xBC\xE6\x1D\x01\xBA\x8A\xD6\xB7\x17\x80\xE2\xDE\xC5\xFB\x89\xE5\xAE\x90\xCB\x59\x3E\x57\xBC\x62\x58\xFD\xD9\x4E\x17",
			.hash_len = 48
		},
		{
			.message = "",
			.message_len = 0,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\x0E\xAB\x42\xDE\x4C\x3C\xEB\x92\x35\xFC\x91\xAC\xFF\xE7\x46\xB2\x9C\x29\xA8\xC3\x66\xB7\xC6\x0E\x4E\x67\xC4\x66\xF3\x6A\x43\x04\xC0\x0F\xA9\xCA\xF9\xD8\x79\x76\xBA\x46\x9B\xCB\xE0\x67\x13\xB4\x35\xF0\x91\xEF\x27\x69\xFB\x16\x0C\xDA\xB3\x3D\x36\x70\x68\x0E",
			.hash_len = 64
		},
		{
			.message = "The quick brown fox jumps over the lazy dog",
			.message_len = 43,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\xD1\x35\xBB\x84\xD0\x43\x9D\xBA\xC4\x32\x24\x7E\xE5\x73\xA2\x3E\xA7\xD3\xC9\xDE\xB2\xA9\x68\xEB\x31\xD4\x7C\x4F\xB4\x5F\x1E\xF4\x42\x2D\x6C\x53\x1B\x5B\x9B\xD6\xF4\x49\xEB\xCC\x44\x9E\xA9\x4D\x0A\x8F\x05\xF6\x21\x30\xFD\xA6\x12\xDA\x53\xC7\x96\x59\xF6\x09",
			.hash_len = 64
		},
		{
			.message = "a",
			.message_len = 1,
			.message_repeat = 1000000,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\x5C\xF5\x3F\x2E\x55\x6B\xE5\xA6\x24\x42\x5E\xDE\x23\xD0\xE8\xB2\xC7\x81\x4B\x4B\xA0\xE4\xE0\x9C\xBB\xF3\xC2\xFA\xC7\x05\x6F\x61\xE0\x48\xFC\x34\x12\x62\x87\x5E\xBC\x58\xA5\x18\x3F\xEA\x65\x14\x47\x12\x43\x70\xC1\xEB\xF4\xD6\xC8\x9B\xC9\xA7\x73\x10\x63\xBB",
			.hash_len = 64
		},
		{
			.message = "\xCC",
			.message_len = 1,
			.message_repeat = 1,
			.salt_len = 0,
			.rounds = 0,
			.hash = "\x86\x30\xC1\x3C\xBD\x06\x6E\xA7\x4B\xBE\x7F\xE4\x68\xFE\xC1\xDE\xE1\x0E\xDC\x12\x54\xFB\x4C\x1B\x7C\x5F\xD6\x9B\x64\x6E\x44\x16\x0B\x8C\xE0\x1D\x05\xA0\x90\x8C\xA7\x90\xDF\xB0\x80\xF4\xB5\x13\xBC\x3B\x62\x25\xEC\xE7\xA8\x10\x37\x14\x41\xA5\xAC\x66\x6E\xB9",
			.hash_len = 64
		}
	};

	return TEST(kripto_hash_keccak1600, vectors, 13);
}
