/*
 * Copyright (C) 2022 by Gregor Pintar <grpintar@gmail.com>
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 */

#include <kripto/block.h>
#include <kripto/block/anubis.h>

#include "test.h"

int main(void)
{
	/* Test vectors from https://web.archive.org/web/20110706163044/http://www.larc.usp.br/~pbarreto/AnubisPage.html */
	const struct vector vectors[28] =
	{
		/* 128-bit */
		{
			.key_len = 16,
			.tweak_len = 0,
			.rounds = 0,
			.iterations = 1,
			.key = "\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.pt = "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.ct = "\xB8\x35\xBD\xC3\x34\x82\x9D\x83\x71\xBF\xA3\x71\xE4\xB3\xC4\xFD"
		},
		{
			.key_len = 16,
			.tweak_len = 0,
			.rounds = 0,
			.iterations = 1,
			.key = "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01",
			.pt = "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.ct = "\xE6\x14\x1E\xAF\xEB\xE0\x59\x3C\x48\xE1\xCD\xF2\x1B\xBA\xA1\x89"
		},
		{
			.key_len = 16,
			.tweak_len = 0,
			.rounds = 0,
			.iterations = 1,
			.key = "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.pt = "\x00\x00\x20\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.ct = "\xE0\xD5\xFD\x6C\x8E\xFC\x1C\xFE\x17\x81\x9D\xA6\x01\x0E\x8B\xCD"
		},
		{
			.key_len = 16,
			.tweak_len = 0,
			.rounds = 0,
			.iterations = 1000,
			.key = "\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01",
			.pt = "\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01",
			.ct = "\x8C\x0A\x6F\x82\x55\xC0\x05\xED\x91\xAD\x08\x40\x6C\x61\xC3\x67"
		},
		/* 160-bit */
		{
			.key_len = 20,
			.tweak_len = 0,
			.rounds = 0,
			.iterations = 1,
			.key = "\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.pt = "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.ct = "\x97\x59\x79\x4B\x5C\xA0\x70\x73\x24\xEF\xB3\x58\x67\xCA\xD4\xB3"
		},
		{
			.key_len = 20,
			.tweak_len = 0,
			.rounds = 0,
			.iterations = 1,
			.key = "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01",
			.pt = "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.ct = "\xB8\x0D\xFB\x9B\xE4\xA1\x58\x87\xB3\x76\xD5\x02\x18\x95\xC1\x2E"
		},
		{
			.key_len = 20,
			.tweak_len = 0,
			.rounds = 0,
			.iterations = 1,
			.key = "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.pt = "\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.ct = "\x11\xA0\x7A\xCA\xBD\xBF\x29\xA0\x6E\x3A\x9F\x08\x0B\x77\xB1\xF5"
		},
		{
			.key_len = 20,
			.tweak_len = 0,
			.rounds = 0,
			.iterations = 1000,
			.key = "\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02",
			.pt = "\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02",
			.ct = "\x3F\x76\xD7\x32\x98\x3E\x00\x92\xAC\x44\x6F\x1B\x16\xC8\x4E\xBB"
		},
		/* 192-bit */
		{
			.key_len = 24,
			.tweak_len = 0,
			.rounds = 0,
			.iterations = 1,
			.key = "\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.pt = "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.ct = "\x7D\x62\x3B\x52\xC7\x4C\x64\xD8\xEB\xC7\x2D\x57\x97\x85\x43\x8F"
		},
		{
			.key_len = 24,
			.tweak_len = 0,
			.rounds = 0,
			.iterations = 1,
			.key = "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01",
			.pt = "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.ct = "\xB1\x0A\x59\xDD\x5D\x5D\x8D\x67\xEC\xEE\x4A\xC4\xBE\x4F\xA8\x4F"
		},
		{
			.key_len = 24,
			.tweak_len = 0,
			.rounds = 0,
			.iterations = 1,
			.key = "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.pt = "\x00\x00\x00\x40\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.ct = "\xA8\xD6\x27\xB2\x24\x3C\x89\x64\x8C\x34\x88\x27\x6E\xC7\xE8\xF4"
		},
		{
			.key_len = 24,
			.tweak_len = 0,
			.rounds = 0,
			.iterations = 1000,
			.key = "\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02",
			.pt = "\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02\x02",
			.ct = "\x72\x38\x7F\xC8\xF2\x54\x8A\x8C\xCE\xF0\x6F\xA7\x76\xC8\x7D\x60"
		},
		/* 224-bit */
		{
			.key_len = 28,
			.tweak_len = 0,
			.rounds = 0,
			.iterations = 1,
			.key = "\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.pt = "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.ct = "\x68\x9E\x05\x94\x6A\x94\x43\x8F\xE7\x8E\x37\x3D\x24\x97\x92\xF5"
		},
		{
			.key_len = 28,
			.tweak_len = 0,
			.rounds = 0,
			.iterations = 1,
			.key = "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01",
			.pt = "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.ct = "\xDD\xB7\xB0\xB4\xE9\xB4\x9B\x9C\x38\x20\x25\x0B\x47\xC2\x1F\x89"
		},
		{
			.key_len = 28,
			.tweak_len = 0,
			.rounds = 0,
			.iterations = 1,
			.key = "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.pt = "\x00\x00\x00\x40\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.ct = "\xF1\x8A\x0E\x8C\xB6\x83\x6C\x26\x29\xF7\xAE\xD8\x43\xB3\x40\xED"
		},
		{
			.key_len = 28,
			.tweak_len = 0,
			.rounds = 0,
			.iterations = 1000,
			.key = "\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03",
			.pt = "\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03",
			.ct = "\xF6\x9A\x2E\xA6\xCA\x33\xAC\x31\xAC\xB6\x24\xDF\x1B\x30\xD2\xB0"
		},
		/* 256-bit */
		{
			.key_len = 32,
			.tweak_len = 0,
			.rounds = 0,
			.iterations = 1,
			.key = "\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.pt = "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.ct = "\x96\x00\xF0\x76\x91\x69\x29\x87\xF5\xE5\x97\xDB\xDB\xAF\x1B\x0A"
		},
		{
			.key_len = 32,
			.tweak_len = 0,
			.rounds = 0,
			.iterations = 1,
			.key = "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01",
			.pt = "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.ct = "\x69\x9C\xAF\xDD\x94\xC7\xBC\x60\x44\xFE\x02\x05\x8A\x6E\xEF\xBD"
		},
		{
			.key_len = 32,
			.tweak_len = 0,
			.rounds = 0,
			.iterations = 1,
			.key = "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.pt = "\x00\x00\x00\x40\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.ct = "\x20\x69\x19\xB9\x13\xD7\xF2\x80\x41\xDC\x43\x98\xB7\x64\xF2\xE8"
		},
		{
			.key_len = 32,
			.tweak_len = 0,
			.rounds = 0,
			.iterations = 1000,
			.key = "\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04",
			.pt = "\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04\x04",
			.ct = "\x65\x06\x98\xD3\x3A\x6E\x68\x85\x3B\x78\x47\x89\x60\xB7\x43\x60"
		},
		/* 288-bit */
		{
			.key_len = 36,
			.tweak_len = 0,
			.rounds = 0,
			.iterations = 1,
			.key = "\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.pt = "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.ct = "\x0F\xC7\xA2\xC0\x11\x17\xAC\x43\x52\x5E\xDF\x6C\xF3\x96\x33\x6C"
		},
		{
			.key_len = 36,
			.tweak_len = 0,
			.rounds = 0,
			.iterations = 1,
			.key = "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01",
			.pt = "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.ct = "\xAD\x08\x4F\xED\x55\xA6\x94\x3E\x7E\x5E\xED\x05\xA1\x9D\x41\xB4"
		},
		{
			.key_len = 36,
			.tweak_len = 0,
			.rounds = 0,
			.iterations = 1,
			.key = "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.pt = "\x00\x00\x00\x40\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.ct = "\x33\xA0\x50\xBF\x3B\x25\x88\xB0\x68\xB5\x97\x14\x1A\xE1\x65\xB7"
		},
		{
			.key_len = 36,
			.tweak_len = 0,
			.rounds = 0,
			.iterations = 1000,
			.key = "\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05",
			.pt = "\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05",
			.ct = "\x06\x47\x3A\x9A\x0A\xE0\xB7\x30\x62\xA3\xE0\x2F\xCD\x1C\x23\xDF"
		},
		/* 320-bit */
		{
			.key_len = 40,
			.tweak_len = 0,
			.rounds = 0,
			.iterations = 1,
			.key = "\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.pt = "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.ct = "\xFE\xE2\x0E\x2A\x9D\xC5\x83\xBA\xA3\xA6\xD6\xA6\xF2\xE8\x06\xA5"
		},
		{
			.key_len = 40,
			.tweak_len = 0,
			.rounds = 0,
			.iterations = 1,
			.key = "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01",
			.pt = "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.ct = "\x86\x3D\xCC\x4A\x60\x34\x9C\x28\xA7\xDA\xA4\x3B\x0A\xD7\xFD\xC7"
		},
		{
			.key_len = 40,
			.tweak_len = 0,
			.rounds = 0,
			.iterations = 1,
			.key = "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.pt = "\x00\x00\x00\x40\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
			.ct = "\xAC\xF7\x15\x1F\x51\xBE\x8F\x73\x03\x63\xF5\x7C\x81\x03\x0E\x50"
		},
		{
			.key_len = 40,
			.tweak_len = 0,
			.rounds = 0,
			.iterations = 1000,
			.key = "\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF",
			.pt = "\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF",
			.ct = "\x82\x6B\xE2\x4D\xE8\x6F\x7D\xB8\x6A\x55\x08\x59\x0C\x2D\x8C\x37"
		}
	};

	return TEST(kripto_block_anubis, vectors, 28);
}
